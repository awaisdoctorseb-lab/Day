<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="pic3.WEBP">
    <title>Notes</title>
    <style>
        :root { --ios-font: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: var(--ios-font); overflow: hidden; background: #000; }

        #screen { width: 100%; height: 100%; position: relative; background: url('wall.jpg') center/cover no-repeat; }

        /* --- LOCK SCREEN --- */
        #lock-screen { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; color: white; z-index: 10; padding-top: 60px; }
        #lock-time { font-size: 85px; font-weight: 200; }
        #lock-date { font-size: 22px; font-weight: 400; margin-top: -10px; }

        /* --- PASSCODE SCREEN --- */
        #passcode-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.3); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); display: none; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 20; }
        .passcode-dots { display: flex; gap: 20px; margin-bottom: 40px; }
        .dot { width: 14px; height: 14px; border: 1.5px solid white; border-radius: 50%; }
        .dot.filled { background: white; }
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px 25px; }
        .key { width: 80px; height: 80px; border-radius: 50%; background: rgba(255,255,255,0.15); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; }
        .key span:first-child { font-size: 34px; line-height: 1; }
        .key span:last-child { font-size: 10px; letter-spacing: 1px; font-weight: 600; margin-top: 2px; }
        .keypad-footer { width: 80%; display: flex; justify-content: space-between; margin-top: 40px; font-weight: 500; font-size: 16px; }

        /* --- HOME SCREEN --- */
        #home-screen { position: absolute; inset: 0; display: none; padding: 50px 25px; }
        .icon-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 25px 20px; }
        .app-icon { display: flex; flex-direction: column; align-items: center; font-size: 12px; color: white; text-align: center; }
        .app-icon img { width: 62px; height: 62px; border-radius: 14px; margin-bottom: 5px; }
        .dock { position: absolute; bottom: 15px; left: 10px; right: 10px; height: 95px; background: url('bar.jpg') center/cover no-repeat; border-radius: 40px; overflow: hidden; display: flex; justify-content: space-around; align-items: center; padding: 0 10px; }

        /* --- NOTES APP (DARK MODE) --- */
        #notes-app { position: absolute; inset: 0; background: #000; z-index: 100; display: none; flex-direction: column; color: white; }
        .notes-list-header { padding: 50px 20px 10px; display: flex; justify-content: space-between; align-items: center; }
        .notes-list-header h1 { font-size: 34px; margin: 0; }
        .more-circle { width: 28px; height: 28px; border: 1.5px solid #d4a017; border-radius: 50%; color: #d4a017; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .notes-container { flex: 1; overflow-y: auto; padding: 10px 20px; }
        .note-item { padding: 15px 0; border-bottom: 0.5px solid #333; display: flex; flex-direction: column; }
        .note-item .title { font-weight: bold; font-size: 17px; }
        .note-item .preview { color: #888; font-size: 14px; }
        .new-note-btn { position: absolute; bottom: 30px; right: 30px; color: #d4a017; font-size: 30px; }

        /* Editor */
        #note-editor { position: absolute; inset: 0; background: #000; display: none; flex-direction: column; z-index: 110; }
        .editor-header { padding: 50px 20px 10px; display: flex; justify-content: space-between; color: #d4a017; font-size: 18px; font-weight: 500; }
        #editor-textarea { flex: 1; background: transparent; border: none; color: white; padding: 20px; font-size: 18px; caret-color: #d4a017; resize: none; line-height: 1.4; }
        
        .shake { animation: shake 0.3s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
    </style>
</head>
<body onload="init()">

<div id="screen" onclick="showPasscode()">
    <div id="lock-screen">
        <div id="lock-time">12:00</div>
        <div id="lock-date">Friday, 16 January</div>
    </div>

    <div id="passcode-screen">
        <p style="margin-bottom:20px; font-weight:500;">Enter Passcode</p>
        <div class="passcode-dots">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="keypad" id="keypad"></div>
        <div class="keypad-footer">
            <span>Emergency</span>
            <span onclick="hidePasscode(event)">Cancel</span>
        </div>
    </div>

    <div id="home-screen">
        <div class="icon-grid" id="icons"></div>
        <div class="dock"></div>
    </div>
</div>

<div id="notes-app">
    <div class="notes-list-header">
        <span style="color:#d4a017; font-size:18px;">&lt; Folders</span>
        <div class="more-circle">...</div>
    </div>
    <div class="notes-container">
        <h1>Notes</h1>
        <div id="notes-list-content"></div>
    </div>
    <div class="new-note-btn" onclick="createNewNote()">üìù</div>
</div>

<div id="note-editor">
    <div class="editor-header">
        <span onclick="closeEditor()">&lt; Notes</span>
        <span onclick="saveAndExit()">Done</span>
    </div>
    <textarea id="editor-textarea"></textarea>
</div>

<script>
    let inputCode = "";
    let currentReveal = { day: "", date: "" };
    let notes = JSON.parse(localStorage.getItem('iosNotes')) || [];
    let activeNoteIndex = null;

    const keys = [
        {n:'1', l:''}, {n:'2', l:'A B C'}, {n:'3', l:'D E F'},
        {n:'4', l:'G H I'}, {n:'5', l:'J K L'}, {n:'6', l:'M N O'},
        {n:'7', l:'P Q R S'}, {n:'8', l:'T U V'}, {n:'9', l:'W X Y Z'},
        {n:'X', l:''}, {n:'0', l:''}, {n:'D', l:''}
    ];

    const apps = [
        {name: 'iTunes', img: 'pic1.WEBP'}, {name: 'Clock', img: 'pic2.WEBP'},
        {name: 'Notes', img: 'pic3.WEBP', action: 'openNotes'}, {name: 'Safari', img: 'pic4.WEBP'},
        {name: 'Wallet', img: 'pic5.PNG'}, {name: 'Reminders', img: 'pic6.PNG'},
        {name: 'Settings', img: 'pic7.PNG'}, {name: 'Weather', img: 'pic8.PNG'},
        {name: 'Music', img: 'pic9.PNG'}
    ];

    function init() {
        const keypad = document.getElementById('keypad');
        keys.forEach(k => {
            const div = document.createElement('div');
            div.className = 'key';
            if(k.n === 'X' || k.n === 'D') { div.style.background = "none"; div.innerHTML = ""; }
            else {
                div.innerHTML = `<span>${k.n}</span><span>${k.l}</span>`;
                div.onclick = (e) => { e.stopPropagation(); handleKey(k.n); };
            }
            keypad.appendChild(div);
        });

        const grid = document.getElementById('icons');
        apps.forEach(app => {
            const div = document.createElement('div');
            div.className = 'app-icon';
            div.innerHTML = `<img src="${app.img}"><span>${app.name}</span>`;
            if(app.action) div.onclick = (e) => { e.stopPropagation(); window[app.action](); };
            grid.appendChild(div);
        });

        setInterval(updateClock, 1000);
        updateClock();
        renderNotesList();
    }

    function updateClock() {
        const now = new Date();
        document.getElementById('lock-time').innerText = now.toLocaleTimeString('en-US', { hour12: true, hour: 'numeric', minute: '2-digit' }).replace(/\s?[AP]M/g, '');
        document.getElementById('lock-date').innerText = now.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long' });
    }

    function showPasscode() { document.getElementById('lock-screen').style.display = 'none'; document.getElementById('passcode-screen').style.display = 'flex'; }
    function hidePasscode(e) { e.stopPropagation(); document.getElementById('lock-screen').style.display = 'flex'; document.getElementById('passcode-screen').style.display = 'none'; inputCode = ""; updateDots(); }

    function handleKey(num) {
        if(inputCode.length < 4) {
            inputCode += num;
            updateDots();
            if(inputCode.length === 4) validate();
        }
    }

    function updateDots() {
        const dots = document.querySelectorAll('.dot');
        dots.forEach((dot, i) => dot.classList.toggle('filled', i < inputCode.length));
    }

    function validate() {
        const logic = (n) => (n === '0' ? 9 : parseInt(n) - 1);
        const d1 = logic(inputCode[0]), d2 = logic(inputCode[1]), d3 = logic(inputCode[2]), d4 = logic(inputCode[3]);
        
        const dayMap = {12:"Monday", 23:"Tuesday", 34:"Wednesday", 45:"Thursday", 56:"Friday", 67:"Saturday", 78:"Sunday"};
        const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        
        const dateVal = parseInt(`${d1}${d2}`);
        const monthVal = parseInt(`${d3}${d4}`);

        if (inputCode.endsWith("80") && dayMap[parseInt(inputCode.substring(0,2))]) {
            currentReveal.day = dayMap[parseInt(inputCode.substring(0,2))];
            unlock();
        } else if (dateVal >= 1 && dateVal <= 31 && monthVal >= 1 && monthVal <= 12) {
            currentReveal.date = `${dateVal} ${months[monthVal-1]}`;
            unlock();
        } else {
            document.getElementById('passcode-screen').classList.add('shake');
            setTimeout(() => { document.getElementById('passcode-screen').classList.remove('shake'); inputCode = ""; updateDots(); }, 300);
        }
    }

    function unlock() {
        document.getElementById('passcode-screen').style.display = 'none';
        document.getElementById('home-screen').style.display = 'block';
        
        // Transform the prediction variables in all notes
        notes = notes.map(n => {
            let t = n.text;
            if(currentReveal.day) t = t.replace(/dddd/g, currentReveal.day);
            if(currentReveal.date) t = t.replace(/ddmm/g, currentReveal.date);
            return { ...n, text: t };
        });
        saveNotes();
        renderNotesList();
    }

    function renderNotesList() {
        const list = document.getElementById('notes-list-content');
        list.innerHTML = "";
        notes.forEach((note, i) => {
            const div = document.createElement('div');
            div.className = 'note-item';
            div.onclick = () => openEditor(i);
            const lines = note.text.split('\n');
            div.innerHTML = `<span class="title">${lines[0] || 'New Note'}</span>
                             <span class="preview">${lines[1] || 'No additional text'}</span>`;
            list.appendChild(div);
        });
    }

    function openNotes() { document.getElementById('notes-app').style.display = 'flex'; }
    function createNewNote() { activeNoteIndex = notes.length; notes.push({text: ""}); openEditor(activeNoteIndex); }
    function openEditor(index) {
        activeNoteIndex = index;
        document.getElementById('editor-textarea').value = notes[index].text;
        document.getElementById('note-editor').style.display = 'flex';
    }
    function saveAndExit() {
        notes[activeNoteIndex].text = document.getElementById('editor-textarea').value;
        saveNotes();
        renderNotesList();
        closeEditor();
    }
    function closeEditor() { document.getElementById('note-editor').style.display = 'none'; }
    function saveNotes() { localStorage.setItem('iosNotes', JSON.stringify(notes)); }
</script>
</body>
</html>
